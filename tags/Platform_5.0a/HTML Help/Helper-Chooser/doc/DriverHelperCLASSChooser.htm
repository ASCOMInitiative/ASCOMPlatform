<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
	<title>Chooser Object</title>

	<style type="text/css">
		@import url(dc3_hh.css);
	</style>
</head>
<body>

<h1><a name="DriverHelperCLASSChooser"></a>Chooser Object</h1>

<p>
<!-- See Also -->
<object type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<param name="Command" value="ALink,MENU">
<param name="Text" value="Text:See Also">
<param name="Flags" value="1,,1">
<param name="Item1" value="">
<param name="Item2" value="DriverHelperCLASSChooserC">
</object>&nbsp;&nbsp;&nbsp;
<!-- Example
<object type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<param name="Command" value="ALink,MENU">
<param name="Text" value="Text:Example">
<param name="Flags" value="1,,1">
<param name="Item1" value="">
<param name="Item2" value="DriverHelperCLASSChooserX">
</object>&nbsp;&nbsp;&nbsp; -->
<!-- Properties -->
<object type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<param name="Command" value="ALink,MENU">
<param name="Text" value="Text:Properties">
<param name="Flags" value="1,,1">
<param name="Item1" value="">
<param name="Item2" value="DriverHelperCLASSChooserP">
</object>&nbsp;&nbsp;&nbsp;
<!-- Methods -->
<object type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<param name="Command" value="ALink,MENU">
<param name="Text" value="Text:Methods">
<param name="Flags" value="1,,1">
<param name="Item1" value="">
<param name="Item2" value="DriverHelperCLASSChooserM">
</object>&nbsp;&nbsp;&nbsp;
<!-- Events -->
<object type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<param name="Command" value="ALink,MENU">
<param name="Text" value="Text:Events">
<param name="Flags" value="1,,1">
<param name="Item1" value="">
<param name="Item2" value="DriverHelperCLASSChooserE">
</object>&nbsp;&nbsp;&nbsp;
</p>

<p class=desc>
ASCOM Scope Driver Helper Chooser Object</p>

<h2>Remarks</h2>


<script language="JScript" type="text/jscript">
	function demo_chooser(current) {
		c = new ActiveXObject("DriverHelper.Chooser");
		d = c.Choose(current);
		c = null;
		return(d)
	}
</script>

The Chooser object provides a way for your application to let your user select the telescope to use. The interface is callable from any automation-compliant client including a Windows Script Component (script implementation of an object, see the Windows Script Host documentation that comes with the ASCOM Platform). The object implements IObjectSafety, and reports itself safe for scripting, thus it may be used from within a web browser and dynamic HTML as well.

<p>Calling <a href="DriverHelperChooserMETHChoose.htm">Chooser.Choose()</a> causes a chooser window to appear, with a drop down selector list containing all of the registered Telescope drivers, listed by the driver's friendly/display name. The user sees a list of telescope types and selects one. 

<p>Before the OK button will light up, however, the user must click the Setup button, causing the selected driver's setup dialog to appear (it calls the driver's Telescope.SetupDialog() method). When the setup dialog is closed, the OK button will light and allow the user to close the Chooser itself. 

<p>The Choose() method returns the DriverID of the selected driver. Choose() allows you to optionally pass the DriverID of a "current" driver (you probably save this in the registry), and the corresponding telescope type is pre-selected in the Chooser's list. In this case, the OK button starts out enabled (lit-up); the assumption is that the pre-selected driver has already been configured.

<p>Click the button below to display the Chooser. The code to do this it really simple, and illustrates the power of ASCOM. You can call ASCOM objects from within a web page (you're looking at one now).

<pre><code>Set chsr = CreateObject("DriverHelper.Chooser")
DriverID = chsr.Choose</code></pre>

Play with the chooser here. The ASCOM telescope simulator has a driverID of "ScopeSim.Telescope". Click the button to display the chooser. The text box will show what comes back from the call to Choose. Leave it there and click again to see the pre-select feature.

<p>Current Driver's ID: <input class=small type=text id="chsr_input">
<input class=small type="button" value="Show Chooser" onClick="chsr_input.value = demo_chooser(chsr_input.value)">

<h2>System Registry Usage</h2>

The Chooser identifies installed ASCOM Telescope drivers by enumerating the subkeys below the following location in the system registry:

<pre><code>HKEY_LOCAL_MACHINE
  Software
    ASCOM
      Telescope Drivers</code></pre>

Each sub-key name is the the DriverID (COM ProgID) of an ASCOM Telescope driver. The default/unnamed value under each sub-key is the descriptive string that appears in the Chooser's dropdown list.

<div class=note>Do not call the Win32 registry API directly to create entries in the Chooser's registry area. Use the <a href="DriverHelperProfileMETHRegister.htm">Register()</a> method of the <a href="DriverHelperCLASSProfile.htm">DriverHelper.Profile</a> object.</div>

<hr color="silver" size=2>
<div class=copyright>Copyright &copy; 2001-2007, The ASCOM Initiative</div>

<Object type="application/x-oleobject"classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
    <param name="ALink Name" value="DriverHelperCLASSProfileC">
</OBJECT>


<object type="application/x-oleobject" 
	classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
	<param name="ALink Name" value="DriverHelperCLASSChooserO">
</object>

</body>
</html>

