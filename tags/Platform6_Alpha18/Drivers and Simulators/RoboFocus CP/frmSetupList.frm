VERSION 5.00
Object = "{5E9E78A0-531B-11CF-91F6-C2863C385E30}#1.0#0"; "MSFLXGRD.OCX"
Begin VB.Form frmSetupList 
   Caption         =   "Focus Setup List"
   ClientHeight    =   6195
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   9075
   Icon            =   "frmSetupList.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   6195
   ScaleWidth      =   9075
   StartUpPosition =   3  'Windows Default
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   15
      Left            =   6930
      TabIndex        =   29
      Top             =   3750
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   14
      Left            =   6930
      TabIndex        =   27
      Top             =   3510
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   13
      Left            =   6930
      TabIndex        =   25
      Top             =   3300
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   12
      Left            =   6930
      TabIndex        =   23
      Top             =   3060
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   11
      Left            =   6930
      TabIndex        =   21
      Top             =   2820
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   10
      Left            =   6930
      TabIndex        =   19
      Top             =   2580
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   9
      Left            =   6930
      TabIndex        =   17
      Top             =   2340
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   8
      Left            =   6930
      TabIndex        =   15
      Top             =   2100
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   7
      Left            =   6930
      TabIndex        =   13
      Top             =   1860
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   6
      Left            =   6930
      TabIndex        =   11
      Top             =   1620
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   5
      Left            =   6930
      TabIndex        =   9
      Top             =   1380
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   4
      Left            =   6930
      TabIndex        =   7
      Top             =   1140
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   3
      Left            =   6930
      TabIndex        =   5
      Top             =   900
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   2
      Left            =   6930
      TabIndex        =   3
      Top             =   660
      Width           =   885
   End
   Begin VB.TextBox txtPos 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   1
      Left            =   6930
      TabIndex        =   1
      Top             =   420
      Width           =   885
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   15
      Left            =   180
      TabIndex        =   28
      Top             =   3750
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   14
      Left            =   180
      TabIndex        =   26
      Top             =   3510
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   13
      Left            =   180
      TabIndex        =   24
      Top             =   3300
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   12
      Left            =   180
      TabIndex        =   22
      Top             =   3060
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   11
      Left            =   180
      TabIndex        =   20
      Top             =   2820
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   10
      Left            =   180
      TabIndex        =   18
      Top             =   2580
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   9
      Left            =   180
      TabIndex        =   16
      Top             =   2340
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      ForeColor       =   &H00FF0000&
      Height          =   255
      Index           =   8
      Left            =   180
      TabIndex        =   14
      Top             =   2100
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   7
      Left            =   180
      TabIndex        =   12
      Top             =   1860
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   6
      Left            =   180
      TabIndex        =   10
      Top             =   1620
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   5
      Left            =   180
      TabIndex        =   8
      Top             =   1380
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   4
      Left            =   180
      TabIndex        =   6
      Top             =   1140
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   3
      Left            =   180
      TabIndex        =   4
      Top             =   900
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   2
      Left            =   180
      TabIndex        =   2
      Top             =   660
      Width           =   6765
   End
   Begin VB.TextBox txtGrid 
      Appearance      =   0  'Flat
      Height          =   255
      Index           =   1
      Left            =   180
      TabIndex        =   0
      Top             =   420
      Width           =   6765
   End
   Begin VB.CommandButton cmdUse 
      Caption         =   "&Go To Selected Position"
      Enabled         =   0   'False
      Height          =   555
      Left            =   2250
      TabIndex        =   31
      Top             =   4290
      Width           =   1935
   End
   Begin VB.CommandButton cmdSave 
      Caption         =   "&Save Current Position in New Setup"
      Enabled         =   0   'False
      Height          =   555
      Left            =   210
      TabIndex        =   30
      Top             =   4290
      Width           =   1935
   End
   Begin VB.TextBox txtEdit 
      Appearance      =   0  'Flat
      BorderStyle     =   0  'None
      ForeColor       =   &H00FF0000&
      Height          =   285
      Left            =   630
      TabIndex        =   34
      Text            =   "Text1"
      Top             =   4170
      Visible         =   0   'False
      Width           =   2775
   End
   Begin VB.CommandButton cmdDelete 
      Caption         =   "&Delete Selected Setup"
      Height          =   555
      Left            =   4320
      TabIndex        =   32
      Top             =   4290
      Width           =   1935
   End
   Begin MSFlexGridLib.MSFlexGrid setupGrid 
      Height          =   3945
      Left            =   240
      TabIndex        =   35
      Top             =   4950
      Width           =   7605
      _ExtentX        =   13414
      _ExtentY        =   6959
      _Version        =   393216
      Rows            =   16
      FixedCols       =   0
      GridColor       =   -2147483643
      FocusRect       =   2
      GridLines       =   2
      ScrollBars      =   0
      FormatString    =   $"frmSetupList.frx":0E42
   End
   Begin VB.CommandButton cmdClose 
      Caption         =   "&Close"
      Height          =   555
      Left            =   6900
      TabIndex        =   33
      Top             =   4290
      Width           =   885
   End
   Begin VB.Label Label2 
      Appearance      =   0  'Flat
      BackColor       =   &H80000004&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "     Position"
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   6930
      TabIndex        =   37
      Top             =   180
      Width           =   885
   End
   Begin VB.Label Label1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000004&
      BorderStyle     =   1  'Fixed Single
      Caption         =   " Description"
      ForeColor       =   &H80000008&
      Height          =   285
      Left            =   180
      TabIndex        =   36
      Top             =   180
      Width           =   6765
   End
End
Attribute VB_Name = "frmSetupList"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim saveState As Boolean, useState As Boolean, deleteState As Boolean, closeState As Boolean
Dim initializing As Boolean
Dim selectedRow As Integer

Const numRows As Integer = 15

Private Sub cmdClose_Click()
  
  On Error GoTo errHandler
  
  Unload Me
  
  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList cmdClose_Click: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub cmdDelete_Click()
  
  Dim response
  Dim R As Integer, startRow As Integer
  Dim saveText As String, saveText2 As String
  
  On Error GoTo errHandler
  
  startRow = selectedRow
  
  For R = startRow To numRows - 1
    
    ' save the text from the row below this one
    txtGrid(R).Text = txtGrid(R + 1).Text
    txtPos(R).Text = txtPos(R + 1).Text
  
  Next R
  
  ' blank out the last row
  txtGrid(numRows) = ""
  txtPos(numRows) = ""
  
  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList cmdDelete_Click: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub cmdSave_Click()
  
  Dim R As Integer, currentText As String, newText As String, response
  
  On Error GoTo errHandler
  
  currentText = txtPos(selectedRow).Text
  newText = frmMain!actualPos.Text
  
  If currentText <> "" Then
    response = MsgBox("Replace " & currentText & " with " & newText & "?", _
                                                          vbYesNo + vbQuestion, "Replace?")
  Else
    response = vbYes
  End If
  
  If response = vbYes Then
    ' save the position from the main screen
    txtPos(selectedRow).Text = frmMain!actualPos.Text
    
    ' allow entering the description
    txtGrid(selectedRow).SetFocus
    
  End If

  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList cmdSave_Click: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub cmdUse_Click()
  
  Dim newPos As Long, response
  
  On Error GoTo errHandler
  
  If IsNumeric(txtPos(selectedRow).Text) Then
    
    newPos = txtPos(selectedRow).Text
    
'    response = MsgBox("Are you sure you want to" & vbCrLf & _
'              "go to position " & newPos & "?", vbYesNo + vbQuestion)
    response = vbYes
    
    If response = vbYes Then
      frmMain!actualPos.Text = newPos
      frmMain!actualPos.SetFocus
      SendKeys "{ENTER}"
    End If
  Else
    Call showMsg("Not a valid position value.", "", 3)
  End If
  
  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList cmdUse_Click: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub Form_Load()
  
  Dim R As Integer, C As Integer
  
  On Error GoTo errHandler
  
  initializing = True
  
  Call setFormPositionIni(Me, "0 2000 8100 5400")
  
  If frmComm!commControl.PortOpen = True Then
    frmSetupList!cmdSave.Enabled = True
    frmSetupList!cmdUse.Enabled = True
  Else
    frmSetupList!cmdSave.Enabled = False
    frmSetupList!cmdUse.Enabled = False
  End If
  
  For R = 1 To numRows
    txtGrid(R).Text = IniGetData("Saved Setups", R & "|0", "", glIniFile)
    txtGrid(R).ForeColor = Black
    
    txtPos(R).Text = IniGetData("Saved Setups", R & "|1", "", glIniFile)
    txtPos(R).ForeColor = Black
  Next R
  
  initializing = False

  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList Form_Load: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub Form_Unload(Cancel As Integer)
  
  Dim R As Integer, C As Integer
  
  On Error GoTo errHandler
  
  For R = 1 To numRows
      
    Call iniPutData("Saved Setups", R & "|0", txtGrid(R).Text, glIniFile)
    Call iniPutData("Saved Setups", R & "|1", txtPos(R).Text, glIniFile)
    
  Next R
  
  Call saveFormPosition(Me)
  
  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList Form_Unload: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Sub EditKeyCode(Grid As Control, Edt As Control, KeyCode As Integer, Shift As Integer)

  On Error GoTo errHandler
  
  ' Standard edit control processing.
  Select Case KeyCode

    Case 27   ' ESC: hide, return focus to MSHFlexGrid.
'      Edt.Visible = False
'      Grid.SetFocus
  
    Case 13   ' ENTER: return focus to MSHFlexGrid.
'      Grid.Text = Edt.Text
'
'      Edt.Visible = False
'      Grid.SetFocus
  
    Case 38      ' Up-arrow
      KeyCode = 0
      DoEvents
      If Grid.Row > Grid.FixedRows Then
        Grid.Text = Edt.Text
  
        Edt.Visible = False
        Grid.SetFocus
  
        Grid.Row = Grid.Row - 1
      End If
  
    Case 40      ' Down-arrow
      KeyCode = 0
      DoEvents
      If Grid.Row < Grid.Rows - 1 Then
        Grid.Text = Edt.Text
        
        Edt.Visible = False
        Grid.SetFocus
      
        Grid.Row = Grid.Row + 1
      End If
       
  End Select
  
  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList editKeyCode: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Sub enableSetupButtons(state As Boolean)

  On Error GoTo errHandler
  
  If state Then
    
    cmdSave.Enabled = saveState
    cmdUse.Enabled = useState
    
  Else
    
    saveState = cmdSave.Enabled
    cmdSave.Enabled = state
    
    useState = cmdUse.Enabled
    cmdUse.Enabled = state
    
  End If
  
  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList enableSetupButtons: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub txtGrid_GotFocus(Index As Integer)

  On Error GoTo errHandler
  
  If selectedRow > 0 Then
    txtGrid(selectedRow).ForeColor = Black
    txtPos(selectedRow).ForeColor = Black
    
    txtGrid(selectedRow).BackColor = White
    txtPos(selectedRow).BackColor = White
  End If
  
  selectedRow = Index
  txtGrid(Index).ForeColor = White
  txtPos(Index).ForeColor = White

  txtGrid(Index).BackColor = Blue
  txtPos(Index).BackColor = Blue

  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList txtGrid_GotFocus: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

Private Sub txtPos_GotFocus(Index As Integer)
  
  On Error GoTo errHandler
  
  If selectedRow > 0 Then
    txtGrid(selectedRow).ForeColor = Black
    txtPos(selectedRow).ForeColor = Black
    
    txtGrid(selectedRow).BackColor = White
    txtPos(selectedRow).BackColor = White
  End If
  
  selectedRow = Index
  txtGrid(Index).ForeColor = White
  txtPos(Index).ForeColor = White

  txtGrid(Index).BackColor = Blue
  txtPos(Index).BackColor = Blue

  Exit Sub
  
errHandler:
  
  Call showMsg("Error in frmSetupList txtPos_GotFocus: " & Err.Description, "", 3)
  
  On Error GoTo 0
  Resume Next
  
End Sub

