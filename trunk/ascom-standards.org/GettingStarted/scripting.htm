<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- #BeginTemplate "/Templates/Fixed_Fluid.dwt" --><!-- DW6 -->
 
<head><!-- #BeginEditable "Title" -->
<title>Getting Started with Scripting</title>
<!-- #EndEditable -->

<link rel="stylesheet" type="text/css" href="../Styles/Fixed_Fluid.css" />

<script type="text/javascript" language="javascript" src="../jscripts/Navigation.js"></script>

</head>
 
<body>

<div id="banner">
	<img style="position: absolute; top: 20px; left: 20px;" alt="ASCOM Standards for Astronomy" src="../Images/ASCOM-Logo.jpg" />
	
	<div id="breadcrumbs">
	<script type="text/javascript" language="javascript">
	<!-- 
	breadcrumbs(); 
	-->
	</script>
</div>

	<div class="topmenucontainer">
    <script type="text/javascript" language="javascript">
      <!-- 
	        writemainmenu();
	        -->
    </script>
  </div>
</div>



<div id="leftcontent">


	<div class="LeftNav">
	<div class="center"><div class="north"><div class="south">
	<script type="text/javascript" language="javascript">
	<!-- 
	writesubmenu(); 
	-->
	</script>
	
	</div></div></div></div>

	<!-- #BeginEditable "LeftNav" -->	<!-- #EndEditable --></div>
<div id="centercontent">
	<!-- #BeginEditable "MainContent" -->
	<h3>Getting Started with Scripting </h3>
	<!--
	NOTE: <BR> required after <LI> elements on Netscape, else
	padding-top in style ignored!
-->
	<dl>
		<dt><b>Note:</b> </dt>
		<dd>Most of the samples shown here are complete scripts that can be run 
		with the standard Windows Scripting Host. You can type them into Notepad, 
		save them, and run them using cscript (from a shell/DOS prompt), or by double-clicking 
		the script icon (which uses wscript). Of course, you can use the &quot;meat&quot; 
		of the examples in your own scripts. </dd>
		<dt><b>Contents:</b> </dt>
		<dd><a href="#hworld">Hello World!</a><br />
		<a href="#tips">An Old Salt&#39;s Tips for Learning and Having Fun</a><br />
		<a href="#toolbox">Useful Tools and Information</a> (including <b>debugging</b>)<br />
		<a href="#creating">Creating Objects</a><br />
		<a href="#objects">What&#39;s with the dots? Objects and Components</a><br />
		<a href="#dragdrop">Process Files via Drag and Drop</a><br />
		<a href="#objcreate">Creating an Object for Use</a><br />
		<a href="#webget">Mine the Web for Data in 4 lines</a><br />
		<a href="#excel">Start Excel, open a spreadsheet, and get data from it</a><br />
		</dd>
	</dl>
	<hr />
	<h3><a name="hworld">Hello World!</a></h3>
	Here&#39;s a quick example showing how easy it is to use scripts on Windows:
	<ol>
		<li>Using notepad, create a file c:\hello.vbs, containing:
		<pre>WScript.Echo &quot;Hello World&quot;
WScript.Echo &quot;It is now &quot; &amp; Now()</pre>
		Save it to disk. </li>
		<li>Double click the icon for this file in the Explorer. </li>
		<li>Now open a command window and type
		<pre>C:\&lt; cscript hello.vbs</pre>
		</li>
	</ol>
	Look in the
	<a target="aux" href="http://download.microsoft.com/download/winscript56/Install/5.6/W982KMeXP/EN-US/scrdoc56en.exe">
	Windows Scripting Host documentation</a> for the <b>WScript</b> object&#39;s properties 
	and methods (see <a href="#objects">&quot;What&#39;s With the Dots?&quot;</a> below), and 
	for the double-click and cscript ways of invoking scripts in Windows.
	<h3><a name="tips">An Old Salt&#39;s Tips for Learning and Having Fun</a></h3>
	<i>written by Bob Denny</i>
	<p>I wrote my first computer program (for the IBM 1401) when I was 18. That 
	was 40 years ago! I&#39;ve been programming computers continuously for that long. 
	Obviously I love it. Along the way, I&#39;ve had to learn tons of languages, operating 
	systems, development systems, and new ways of thinking about things. Learning 
	doesn&#39;t have to be scary, it can be <b>fun</b>. Amateur astronomy is about learning 
	and doing as well, right? Those of us over 50 know that learning is what keeps 
	us from rusting out! For younger people, learning is what creates new opportunities. 
	OK, enough soap box. </p>
	<p>Once you learn your <i>second</i> computer language, or your <i>second</i> 
	operating system, you will have discoverd that it&#39;s not nearly as painful as 
	the first. Subsequent ones become even easier. All of these systems and languages 
	have commonalities just like spoken languages and socio-economic systems.
	</p>
	<ol>
		<li>The keys to any new system are contained in the documentation. Here&#39;s 
		the first and <i>most important</i> tip:
		<p></p>
		<blockquote>
			<i>Skim read</i> the documentation <i>first thing</i>, before doing 
			any designing or coding.</blockquote>
		<p>This is extremely important. Skim-read, don&#39;t try to remember anything, 
		just expose yourself to what&#39;s there. If you relax and browse through the 
		docs, you&#39;ll subconsciously absorb key concepts and form abstract ideas. 
		Later on, while you&#39;re designing and coding, you&#39;ll face situations where 
		you need to do something that appears difficult. Quite often a light bulb 
		will go on: &quot;I remember seeing something about ____ in the docs. Let&#39;s see 
		now...&quot; You know where things are, more or less, and you know that there 
		is a nugget in there somewhere. Discovery is fun! Remember, you&#39;re not the 
		first programmer in the history of the world, others before you have found 
		elegant solutions to both common and obscure problems. Be a pro and use 
		the right tools for the job. </p>
		<p></p>
		</li>
		<li>You can&#39;t learn to drive a car from a book, right? Here&#39;s my second 
		tip:
		<p></p>
		<blockquote>
			Play with samples and others&#39; code, using the system and language, before 
			tackling your primary project.</blockquote>
		The chances of your designing and coding something useful on a new system 
		are nil if you think you can (maybe) skim the docs and then build the program. 
		Forget it. You really need to play around with the development tools, the 
		language, the samples(!), and the &quot;library&quot; and/or &quot;object models&quot;. Read 
		lots of sample and real code! Get sources to study! Write some small programs 
		that do simple things. Modify existing code to change its behavior. Play 
		with the debugger if that&#39;s available. This isn&#39;t contradictory to (1); 
		I said &quot;skim read&quot; there.
		<p></p>
		</li>
		<li>It&#39;s virtually impossible to understand the depth and character of the 
		problem until you try to solve it. Writing a program to handle a task <i>
		always</i> uncovers things about the task that you didn&#39;t understand when 
		you started. So here&#39;s my third tip:
		<p></p>
		<blockquote>
			Plan to throw the first one away.</blockquote>
		and its corollary
		<p></p>
		<blockquote>
			Never make a prototype good enough to ship.</blockquote>
		When you get to the point where you&#39;re saying to yourself &quot;If I&#39;d only known
		<i>that</i>, I would have done things differently!&quot;... consider doing things 
		differently. Be a pro. As said in The Gambler, learn to know when to hold 
		&#39;em and when to fold &#39;em. And if you&#39;re working for someone else as a programmer, 
		don&#39;t ever let them ship your prototype. They will do it if possible, and 
		&quot;credit&quot; you with the problems yet credit themselves for the success.
		</li>
	</ol>
	<hr />
	<h3><a name="toolbox">Useful Tools and Information</a></h3>
	<div class="annce">
		None of the ASCOM Initiative members have any business relationship with 
		software companies and/or their products listed below.</div>
	<dl>
		<dt><b>Language Engines and Host (&quot;runner&quot;)</b> </dt>
		<dd>Most people are surprised to discover that the common scripting engines 
		and a &quot;runner&quot; program are already resident on their Windows computers. 
		There are a number of versions of this stuff floating around. We recommend 
		that you update your system to include the latest VBScript, JScript engines 
		and scripting host. The easiest way to do this is to install the
		<a target="aux" href="http://ASCOM-Standards.org/downloads.html">latest 
		ASCOM Platform</a>, which includes the latest Microsoft Script technology. 
		Alternatively, you can install just the Windows Script support from the
		<a target="aux" href="http://msdn.microsoft.com/scripting/">Microsoft Scripting 
		site</a>, but be aware that you may need other operating system updates 
		which depend on other operating system updates, etc. At a minimum, read 
		the caveats on the download page carefully. </dd>
		<dt><b>Documentation</b> </dt>
		<dd>Neither of the above packages contain documentation on any scripting 
		engines. We strongly recommend you get the latest
		<a target="aux" href="http://download.microsoft.com/download/winscript56/Install/5.6/W982KMeXP/EN-US/scrdoc56en.exe">
		Microsoft Windows Script Technologies</a> document. This has tutorials for 
		VBScript and JScript, and reference information for the script runner, which 
		has some very very useful built-in objects. Read about the WScript objects.
		</dd>
		<dt><b>Command Shells</b> </dt>
		<dd>If you started computing with the Mac or Windows, you probably haven&#39;t 
		used a command shell. If you have used just about anything else, you have. 
		Even the lowly &quot;DOS prompt&quot; is a (very crude) shell. GUI interfaces are 
		great for interactive programs like word processors and web browsers. But 
		for doing real data processing, crunching data into results, there&#39;s no 
		substitute for a good shell and command language. Professional astronomers 
		running Unix systems make heavy use of shell programming to automate their 
		tasks. A real shell has a command language that is a full-fledged scripting 
		language (slanted to controlling/running things rather than crunching data 
		etc.). After you struggle with the DOS prompt for a few days, you&#39;ll be 
		ready to scream. When you reach that point, check out
		<a target="aux" href="http://jpsoft.com/products.htm">4NT from JP Software</a>.You 
		can <a target="aux" href="ftp://jpsoft.com/4nt/4nt400.exe">download a trial 
		version</a>. There are also other shells available for Windows platforms.
		</dd>
		<dt><b>Editors</b> </dt>
		<dd>At first, it seems like using Notepad for writing scripts is so <i>easy</i>. 
		But eventually, you&#39;re going to look for alternatives. Leading the way for 
		a new generation of scripting editors is
		<a target="aux" href="http://www.sapien.com/">PrimalSCRIPT from Sapien Software</a>. 
		This editor is language sensitive with syntax coloring for many languages 
		including VBScript, JScript, Perl, and Python. The current release has (limited) 
		&quot;intellisense&quot;, popup tips for syntax and object interfaces. You can run 
		scripts from within PrimalSCRIPT and see the results in an output window. 
		Expect this to be expanded to other features in the near future. There are 
		other programmer&#39;s editors out there, however most do not support the newer 
		scripting languages with language sensitivity and syntax coloring. If you&#39;re 
		going to do a lot of development in scripting languages, consider
		<a target="aux" href="http://msdn.microsoft.com/vinterdev/default.asp">Microsoft 
		Visual InterDev</a>. It is designed for heavy-duty development of script 
		and data driven web sites. </dd>
		<dt><b>Debugging</b> </dt>
		<dd>
		<p>An excellent tool for debugging scripts is the &quot;MSE&quot; script debugger 
		in Microsoft Office Professional 2000 &amp; XP, and Visual InterDev 6. If you 
		have any of these three packages,
		<a href="http://www.ascom-standards.org/O2kdebug.htm">click here</a> for 
		details on installing and configuring the MSE debugger. </p>
		<p>You can also use the debugger included with Microsoft Visual Studio.NET 
		for debugging scripts. If you have Visual Studio.NET,
		<a href="http://www.ascom-standards.org/vsnetdebug.htm">click here</a> for 
		details on configuring the Visual Studio.NET debugger.</p>
		<p>If you have <i>both</i> the Office Debugger and Visual Studio.NET configured 
		on your system, and your script raises a run-time error, you will first 
		see a &quot;Just in Time&quot; popup window which will allow you to select which of 
		the two debuggers you want to use. Check them both out thoroughly before 
		using the &quot;make the selected debugger the default&quot; option in that window. 
		Each has its own advantages and disadvantages. I prefer the MSE debugger 
		as it is lighter weight. Either is fine though!</p>
		<p>There are a few tricks that will save you a load of headaches when debugging 
		with either tool: </p>
		<ul>
			<li>To enable the debugger when running a script from Windows Scripting 
			Host (cscript or wscript), include the option //D (yes, that&#39;s <i>two</i> 
			slashes!). </li>
			<li>When using the Windows Scripting Host, to <i>start</i> your script 
			in the debugger, add the //X option. </li>
			<li>To inspect a variable in VBScript, type &quot;? <i>variable</i>&quot; in the 
			debugger command window. For JScript, just type the variable name in 
			the command window (no &#39;?&#39;). </li>
			<li>You can call a function from the debugger&#39;s command window. Any 
			valid expression in the script&#39;s language may be entered into the command 
			window. This is really useful! </li>
			<li>If you change a script, you must start it from scratch. You cannot 
			change a script while it is executing. </li>
		</ul>
		</dd>
	</dl>
	<hr />
	<h3><a name="creating">Creating Objects</a></h3>
	<p>Windows itself and many programs register creatable Windows objects on the 
	computer. ASCOM drivers are creatable objects. In a script, you almost always 
	create objects using the <b>CreateObject()</b> method (built into VBScript) 
	or <b>new ActiveXObject()</b> in JScript. For example, let&#39;s say you want to 
	create an instance of the Telescope Simulator driver:</p>
	<pre>  Set Scope = CreateObject(&quot;ScopeSim.Telescope&quot;)</pre>
	The <b>Simulator.Telescope</b> is called the &quot;ProgID&quot; for the object. The trick 
	is to find out what all of the ProgIDs are for objects on the system. There 
	is no manual or book of these! One tool that can help is OleView, which you 
	can download from Microsoft&#39;s
	<a target="aux" href="http://www.microsoft.com/windows2000/techinfo/reskit/tools/existing/oleview-o.asp">
	Oleview.exe: OLE/COM Object Viewer</a> page. <hr />
	<h3><a name="objects">What&#39;s with the dots? Objects and Components</a></h3>
	You may be wondering what the dots mean in the sample programs. Object oriented 
	systems deal with <i>objects</i> which have <i>properties</i> and <i>methods</i>. 
	Let&#39;s say, for example, that there&#39;s a hypothetical Scope object which represents 
	your scope/mount. To find out what your scope&#39;s current right ascension is, 
	you might use the Scope.RightAscension property:
	<pre>  Set Scope = CreateObject(&quot;ScopeSim.Telescope&quot;)
  Scope.Connected = True
  RA = Scope.RightAscension</pre>
	For properties, the dot is sort of like the possessive apostrophe in English. 
	You can read Scope.Declination as &quot;the scope&#39;s current declination&quot;, or &quot;scope 
	dot declination&quot; in internet-speak.
	<p>A method is like a function call, except it is offered or supported by a 
	specific object. Different objects may have methods with the same name. To call 
	a method, prefix the method call with the object name and a dot. For example, 
	to move our hypothetical scope to a given RA and Dec you might say something 
	like: </p>
	<pre>  Scope.SlewToPosition(RA, Dec)</pre>
	or maybe
	<pre>  Scope.TargetRightAscension = RA
  Scope.TargetDeclination = Dec
  Scope.SlewToTarget
</pre>
	<p>With this in mind, consider the various objects out there as widgets that 
	represent something, provide some related services, etc. Each object has its 
	set of properties and methods. Some properties can only be read. Scope.RightAscension 
	will probably be read-only. Be a pro, skim-read the object docs before diving 
	in. </p>
	<dl>
		<dt><b>Advanced note</b> </dt>
		<dd>A well behaved object follows some simple rules. Methods should &quot;do&quot; 
		something. A method like GetRightAscension() doesn&#39;t do anything, and should 
		really be represented as a read-only property, say, RightAscension. If you 
		see a &quot;method&quot; like SetRightAscension() along with something like GetRightAscension(), 
		you are looking at a really poorly designed interface. If RightAscension 
		were a property, you could say
		<pre>  s.RightAscension = 8.456
  ra = s.RightAscension</pre>
		instead of something ugly like
		<pre>  s.SetRightAscension(8.456)
  ra = s.GetRightAscension()</pre>
		</dd>
	</dl>
	<hr />
	<h3><a name="dragdrop">Process Files via Drag and Drop</a></h3>
	The Windows Script Host allows multiple files to be dragged onto script icons. 
	When you drag files onto a script, the file names are translated into arguments 
	on the command line. These file names can be used to drive repetitive processing 
	on the dropped files. For example, if you could drop a bunch of image files 
	onto a script that uses some object to convert them from one format to another 
	or to calibrate them using dark and/or flat fields. Here&#39;s a VBScript script 
	that illustrates this by simply echoing the file names:
	<pre>  Set objArgs = WScript.Arguments
  For I = 0 to objArgs.Count - 1
    WScript.Echo objArgs(I)
  Next
</pre>
	Type this up and save it. Then drop some files on its icon from the Windows 
	Explorer and see what happens. <hr />
	<h3><a name="objcreate">Creating an Object for Use</a></h3>
	Before using most objects, you first need to create an instance for your use. 
	Th WScript object used above is pre-created for all scripts running in the Windows 
	Scripting Host. To use other objects, you need to create an instance. For example, 
	to read a text file, you use the Scripting Runtime objects (as described in 
	the VBScript and JScript documentation). The following script simply echoes 
	the contents of itself. Create the script and call it self.vbs then <i>run it 
	from a shell</i>.
	<pre>  Dim f, fso
  Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)
  Set f = fso.OpenTextFile(&quot;self.vbs&quot;)
  While Not f.AtEndOfStream
    WScript.Echo f.ReadLine()
  Wend
  f.Close
</pre>
	Note the use of <tt>Set</tt> in creating the FileSystemObject object, and assigning 
	the TextStream object returned by the OPenTextFile() method. In VBScript, you 
	need Set any time you assigning an object to a variable! This will get you till 
	you get used to it. This is not needed in JScript. Other languages handle object 
	variable assignment in various ways. <hr />
	<h3><a name="webget">Mine the Web for Data in 4 lines</a></h3>
	This little script uses the Microsoft Internet Transfer Control to grab data 
	from a web site. In this case, the data is the weather at the remote controlled 
	Berkeley/Lick KAIT telescope, which is used for supernova hunting. <b>NOTE:</b> 
	The ITC requires that you have VB installed on your system.
	<pre>  Set web = CreateObject(&quot;InetCtls.Inet&quot;)
  web.RequestTimeout = 60
  buf = web.OpenURL( _
    &quot;http://astron.berkeley.edu/~bait/weather/weatherd.dat&quot;)
  WScript.Echo buf
</pre>
	<hr />
	<h3><a name="excel">Start Excel, open a spreadsheet, and get data from it</a></h3>
	Suppose you have a catalog or observing list in an Excel spreadsheet. Here is 
	snippet of a hypothetical Excel spreadsheet called my-cat.xls:
	<p align="center">
	<img height="155" alt="" src="cat-pic.gif" width="285" border="0" /> </p>
	<p>and here is a very simple script that grabs the data directly from the cells 
	of the spreadsheet and echoes it as above: </p>
	<pre>  Set sheet = GetObject(&quot;my-cat.xls&quot;).ActiveSheet &#39; This creates the object
  For i = 2 to 3
    WScript.Echo _
          &quot;Obj: &quot; &amp; sheet.cells(i,1) &amp; vbCrLf &amp; _
          &quot;RA:  &quot; &amp; (sheet.cells(i,2) * 24) &amp; vbCrLf &amp; _
          &quot;Dec: &quot; &amp; sheet.cells(i,3) &amp; vbCrLf
  Next</pre>
	This will reference whatever sheet appears when the file is first opened. If 
	you have more than one worksheet in the XLS file, specify the sheet by replacing 
	.ActiveSheet with .Sheet(&quot;SheetName&quot;). Why the multiplication by 24 for the 
	RA? The RA in the spreadsheet is in the form of a Date/Time, which is represented 
	internally in Excel (and VB and all scripting languages as well) as a &quot;date 
	serial&quot;, in units of days. A time with no date has 0 days plus a fractional 
	number representing the part of a day that the time represents. To get hours, 
	multiply by 24.&nbsp;
	<!-- #EndEditable --></div>
<div id="footer">
	Copyright © 1998-2010, The ASCOM Initiative. 
	All rights reserved. </div>

</body>

<!-- #EndTemplate --></html>
