I didn't get this working and ran out of time to pursue it. It might be close. But in the end, the problem still exists with .NET so ...